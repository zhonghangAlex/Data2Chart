{"version":3,"file":"index-2db1c530.js","sources":["../../src/pages/login/index.vue"],"sourcesContent":["<template>\n\t<div class=\"login\">\n\t\t<h1 style=\"color: #333; margin-bottom: 40px\">登录</h1>\n\t\t<a-form>\n\t\t\t<a-form-item label=\"账号：\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 20 }\">\n\t\t\t\t<a-input ref=\"username\" placeholder=\"用户名\">\n\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t<UserOutlined />\n\t\t\t\t\t</template>\n\t\t\t\t</a-input>\n\t\t\t</a-form-item>\n\t\t\t<a-form-item label=\"密码：\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 20 }\">\n\t\t\t\t<a-input-password ref=\"password\" placeholder=\"密码\" />\n\t\t\t</a-form-item>\n\t\t\t<a-form-item label=\"验证码：\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 20 }\">\n\t\t\t\t<div class=\"flex\">\n\t\t\t\t\t<a-input placeholder=\"验证码\" style=\"width: 40%\" @change=\"codeInput\" />\n\t\t\t\t\t<div id=\"svgWrapper\"></div>\n\t\t\t\t\t<a-button type=\"link\" @click=\"refreshImg\">换一个</a-button>\n\t\t\t\t</div>\n\t\t\t</a-form-item>\n\t\t\t<a-form-item :wrapper-col=\"{ span: 14, offset: 4 }\">\n\t\t\t\t<div class=\"flex\">\n\t\t\t\t\t<span></span>\n\t\t\t\t\t<a-button type=\"primary\" style=\"margin-left: 8px\" @click=\"handleSubmit\">登陆</a-button>\n\t\t\t\t\t<a-button @click=\"handleReset\">重置</a-button>\n\t\t\t\t\t<!-- <router-link to=\"/register\" style=\"margin-left: 30px\">去注册</router-link> -->\n\t\t\t\t</div>\n\t\t\t</a-form-item>\n\t\t</a-form>\n\t</div>\n</template>\n\n<script>\nimport { message } from 'ant-design-vue';\nimport { UserOutlined } from '@ant-design/icons-vue';\nimport { loginApi } from '@/api';\nimport { useMainStore } from '@/store/user';\n\nexport default {\n\tcomponents: { UserOutlined },\n\tdata() {\n\t\treturn {\n\t\t\tsubmit: {\n\t\t\t\tuser_name: '',\n\t\t\t\tpassword: '',\n\t\t\t},\n\t\t\tcode: '',\n\t\t\trandomNum: 0.0,\n\t\t};\n\t},\n\tmounted() {\n\t\tthis.refreshImg();\n\t},\n\tmethods: {\n\t\trefreshNum() {\n\t\t\tlet newNum = 0;\n\t\t\twhile (newNum === 0 || newNum === this.randomNum) {\n\t\t\t\tnewNum = Math.random() * 10;\n\t\t\t}\n\t\t\tthis.randomNum = newNum;\n\t\t},\n\t\tcodeInput(e) {\n\t\t\tdocument.cookie = `captcha_client=${e.target.value}`;\n\t\t},\n\t\tasync refreshImg() {\n\t\t\tthis.refreshNum();\n\t\t\tconst svgWrapper = document.getElementById('svgWrapper');\n\t\t\tsvgWrapper.innerHTML = '';\n\t\t\tconst res = await loginApi.getImg({ v: this.randomNum });\n\t\t\tsvgWrapper.innerHTML = res;\n\t\t},\n\t\tasync handleSubmit() {\n\t\t\tconst store = useMainStore();\n\t\t\tconst form = {\n\t\t\t\tuser_name: this.$refs.username.stateValue,\n\t\t\t\tpassword: this.$refs.password.input.stateValue,\n\t\t\t};\n\t\t\tconst fakeUser = {\n\t\t\t\tuser_name: 'alexzhli',\n\t\t\t\tpassword: '123456',\n\t\t\t};\n\t\t\tconst res = await loginApi.login(form || fakeUser);\n\t\t\tstore.updateStatus();\n\t\t\tswitch (res.code) {\n\t\t\t\tcase 0:\n\t\t\t\t\tmessage.success('登录成功,即将跳转到主页');\n\t\t\t\t\tsetTimeout(() => this.$router.push({ path: `/projects` }), 3000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tmessage.error(res.message);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\thandleReset() {\n\t\t\tthis.submit = {};\n\t\t},\n\t},\n};\n</script>\n\n<style>\n.login {\n\twidth: 100%;\n\theight: 100%;\n\tbackground-size: cover;\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n\talign-items: center;\n}\n.flex {\n\twidth: 340px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n}\n#svgWrapper {\n\twidth: 123px;\n\theight: 43px;\n\tborder: 1px solid rgba(0, 0, 0, 0.2);\n}\n</style>\n"],"names":[],"mappings":"iYAuCA"}