var q=Object.defineProperty,N=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var L=(e,t,o)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,F=(e,t)=>{for(var o in t||(t={}))V.call(t,o)&&L(e,o,t[o]);if(C)for(var o of C(t))M.call(t,o)&&L(e,o,t[o]);return e},O=(e,t)=>N(e,T(t));import{f as w,E as A,j as x,r as d,o as l,c as f,p as g,F as B,O as z,b as a,N as v,a as h,q as p,n as J,s as $,y,a5 as R,l as j,D as U,h as G,v as H,x as K}from"./vendor-ea278687.js";import{c as k,d as I,_ as P}from"./index-036ed13c.js";const S={getAllProjects:()=>k({url:"/cms/getAllProjects",method:"get",params:{user_name:I.getItem("user")}}),login:e=>k({url:"/login/validateUsr",method:"post",data:e}),logout:()=>k({url:"/login/logout",method:"post"}),addProject:e=>k({url:"/cms/addProject",method:"post",data:F({user_name:I.getItem("user"),data_string:""},e)})};const Q=w({name:"ProjectList",props:{projectList:{type:Array,required:!0}},setup(e){const{projectList:t}=A(e),o=x();return{recentList:t,handleJump:i=>{let c="";i.share_hash!==""||i.third_finished===1?c="/publish":i.second_finished===1?c="/visual":i.first_finished===1?c="/preprocess":c="/start",o.push({path:c,query:{project_id:i.project_id}})}}}}),W={class:"recently__list"},X=["onClick"],Y={class:"recently__item__title"},Z={class:"recently__item__edit-time"},ee=y("\u8BE6\u60C5"),te={key:1,class:"recently__item__default"},se=y("\u5F00\u59CB"),oe=y("\u9884\u5904\u7406"),ne=y("\u7ED8\u56FE"),ae=y("\u53D1\u5E03");function ce(e,t,o,r,i,c){const n=d("a-empty"),u=d("a-button"),m=d("a-popover"),_=d("a-tag");return l(),f("div",W,[e.recentList.length===0?(l(),g(n,{key:0})):(l(!0),f(B,{key:1},z(e.recentList,s=>(l(),f("div",{key:s.id,class:"recently__item",onClick:E=>e.handleJump(s)},[a("h3",Y,v(s.project_name),1),a("p",Z,v(s.time),1),h(m,{title:"\u8BE6\u7EC6\u4FE1\u606F"},{content:p(()=>[a("p",null,"\u9879\u76EE\u540D\u79F0\uFF1A"+v(s.project_name),1),a("p",null,"\u521B\u5EFA\u7528\u6237\uFF1A"+v(s.user_name),1),a("p",null,"\u521B\u5EFA\u65E5\u671F\uFF1A"+v(s.create_time.slice(0,19).replace("T"," ")),1),a("p",null,"\u6700\u8FD1\u4FEE\u6539\uFF1A"+v(s.modify_time.slice(0,19).replace("T"," ")),1)]),default:p(()=>[h(u,{size:"small",type:"link",class:"recently__item__detail"},{default:p(()=>[ee]),_:1})]),_:2},1024),s.index_pic?(l(),f("div",{key:0,class:"recently__item__picture",style:J({"background-image":`url(${s.index_pic})`})},null,4)):(l(),f("div",te,"\u6682\u65E0\u56FE\u7247")),s.first_finished===1?(l(),g(_,{key:2,color:"orange"},{default:p(()=>[se]),_:1})):$("",!0),s.second_finished===1?(l(),g(_,{key:3,color:"green"},{default:p(()=>[oe]),_:1})):$("",!0),s.third_finished===1?(l(),g(_,{key:4,color:"cyan"},{default:p(()=>[ne]),_:1})):$("",!0),s.share_hash!==""?(l(),g(_,{key:5,color:"blue"},{default:p(()=>[ae]),_:1})):$("",!0)],8,X))),128))])}var le=P(Q,[["render",ce],["__scopeId","data-v-0766f352"]]);const re=w({components:{PlusOutlined:R},setup(){const e=x(),t=j(!1),o=j(!1),r=j("");return{visible:t,confirmLoading:o,handleOk:async()=>{o.value=!0;const n=await S.addProject({project_name:r.value});console.log(n),t.value=!1,o.value=!1;const{project_id:u}=n.result.data;e.push({path:"/start",query:{project_id:u}})},handleCreate:async()=>{t.value=!0},value:r}}}),ie=y(" \u65B0\u5EFA\u9879\u76EE "),ue=a("p",null,"\u4E3A\u4F60\u7684\u65B0\u9879\u76EE\u8D77\u4E00\u4E2A\u540D\u5B57",-1);function _e(e,t,o,r,i,c){const n=d("PlusOutlined"),u=d("a-button"),m=d("a-input"),_=d("a-modal");return l(),f(B,null,[h(u,{type:"primary",size:"large",onClick:e.handleCreate},{icon:p(()=>[h(n)]),default:p(()=>[ie]),_:1},8,["onClick"]),h(_,{visible:e.visible,"onUpdate:visible":t[1]||(t[1]=s=>e.visible=s),title:"\u65B0\u5EFA\u9879\u76EE","confirm-loading":e.confirmLoading,onOk:e.handleOk},{default:p(()=>[ue,h(m,{value:e.value,"onUpdate:value":t[0]||(t[0]=s=>e.value=s),placeholder:"\u9879\u76EE\u540D\u79F0"},null,8,["value"])]),_:1},8,["visible","confirm-loading","onOk"])],64)}var de=P(re,[["render",_e]]);const pe={name:"Projects",components:{ProjectList:le,Modal:de},setup(){const e=U({});let t=[];const o=j([]),r=j([]),i=j(!1);return G(async()=>{const c=await S.getAllProjects();console.log(c),t=c.result.data,t.forEach(n=>{const u=n,m=new Date(n.modify_time).valueOf(),_=new Date().valueOf();let s="";const E=(_-m)/(1e3*60*60*24);if(E>=1)s=`\u6700\u8FD1\u7F16\u8F91\u4E8E ${E.toFixed(0)} \u5929\u524D`;else{const b=(_-m)/(1e3*60*60);b>=1?s=`\u6700\u8FD1\u7F16\u8F91\u4E8E ${b.toFixed(0)} \u5C0F\u65F6\u524D`:s=`\u6700\u8FD1\u7F16\u8F91\u4E8E ${((_-m)/(1e3*60)).toFixed(0)} \u5206\u949F\u524D`}n.time=s,u.share_hash!==""?r.value.push(n):o.value.push(n)})}),O(F({},A(e)),{recentEdit:o,recentPost:r,isClicked:i})}},D=e=>(H("data-v-3744dec1"),e=e(),K(),e),he={class:"container"},me={class:"new-project"},fe={class:"project"},ve={class:"edit-recently recently"},ye=D(()=>a("h2",null,"\u6700\u8FD1\u7F16\u8F91",-1)),je=D(()=>a("div",{class:"divider"},null,-1)),ge={class:"post-recently recently"},$e=D(()=>a("h2",null,"\u6700\u8FD1\u53D1\u5E03",-1));function ke(e,t,o,r,i,c){const n=d("Modal"),u=d("ProjectList");return l(),f("div",he,[a("div",me,[h(n)]),a("div",fe,[a("div",ve,[ye,h(u,{"project-list":r.recentEdit},null,8,["project-list"])]),je,a("div",ge,[$e,h(u,{"project-list":r.recentPost},null,8,["project-list"])])])])}var be=P(pe,[["render",ke],["__scopeId","data-v-3744dec1"]]);export{be as default};
